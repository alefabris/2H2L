<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Games | Z4NE.zone</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="activities.html">Activities</a></li>
      <li><a href="games.html">Games</a></li>
      <li><a href="join.html" class="join-button">Join</a></li>
    </ul>
  </nav>

  <div class="games-wrapper">
    <h1>Games</h1>

    <div class="filter-controls">
      <label>
        Players:
        <select id="playerFilter">
          <option value="">Any</option>
          <option value="2">2+</option>
          <option value="3">3+</option>
          <option value="4">4+</option>
          <option value="5">5+</option>
        </select>
      </label>
      <label>
        Duration:
        <select id="timeFilter">
          <option value="">Any</option>
          <option value="30">‚â§ 30'</option>
          <option value="60">‚â§ 60'</option>
          <option value="90">‚â§ 90'</option>
        </select>
      </label>
      <button id="clearFilters" class="clear-filters">Reset Filters</button>
    </div>

    <!-- GAME: Blood Rage -->
    <div class="game" data-players="2-4" data-players-with-expansion="5">
      <div class="game-meta">
        <span><span class="emoji">üë•</span>: 2‚Äì4 | <span class="emoji">‚è±Ô∏è</span>: 60‚Äì90'</span>
      </div>
      <h2>
        <a href="https://boardgamegeek.com/boardgame/170216/blood-rage" target="_blank">Blood Rage</a>
      </h2>
      <p>Battle-driven area control game set in Norse mythology.</p>
      <div class="expansion">
        <a href="https://boardgamegeek.com/boardgameexpansion/174506/blood-rage-5th-player-expansion" target="_blank">
          5th Player Expansion <span class="expansion-note"><span class="emoji">üë•</span> +1 player</span>
        </a>
        <span>Adds components to include a fifth player.</span>
      </div>
      <div class="expansion">
        <a href="https://boardgamegeek.com/boardgameexpansion/175100/blood-rage-mystics-of-midgard" target="_blank">
          Mystics of Midgard
        </a>
        <span>Introduces mystical warrior units with unique abilities.</span>
      </div>
      <div class="expansion">
        <a href="https://boardgamegeek.com/boardgameexpansion/174801/blood-rage-gods-of-asgard" target="_blank">
          Gods of √Åsgard
        </a>
        <span>Adds gods to the game, affecting each province with unique effects.</span>
      </div>
      <small class="owner">(gasca98)</small>
    </div>

    <!-- GAME: The Witcher: Old World -->
    <div class="game" data-players="1-5">
      <div class="game-meta">
        <span><span class="emoji">üë•</span>: 1‚Äì5 | <span class="emoji">‚è±Ô∏è</span></span>: 90‚Äì150'</span>
      </div>
      <h2>
        <a href="https://boardgamegeek.com/boardgame/331106/the-witcher-old-world" target="_blank">The Witcher: Old World</a>
      </h2>
      <p>Adventure game set in the Witcher universe, where players are rival monster-hunters.</p>
      <div class="expansion">
        <a href="https://boardgamegeek.com/boardgameexpansion/364789/the-witcher-old-world-exclusive-monster-pack" target="_blank">
          Exclusive Monster Pack
        </a>
        <span>Adds unique and powerful monsters to the base game.</span>
      </div>
      <small class="owner">(gasca98)</small>
    </div>

    <!-- GAME: Unicorn Overlord -->
    <div class="game" data-players="2-4">
      <div class="game-meta">
        <span><span class="emoji">üë•</span>: 2‚Äì4 | <span class="emoji">‚è±Ô∏è</span>: 20‚Äì30'</span>
      </div>
      <h2>
        <a href="https://boardgamegeek.com/boardgame/412062/unicorn-overlord-official-card-game" target="_blank">
          Unicorn Overlord: Official Card Game
        </a>
      </h2>
      <p>Card game inspired by the tactical RPG Unicorn Overlord, for fast-paced strategy duels.</p>
      <small class="owner">(gasca98)</small>
    </div>

    <!-- GAME: Skull -->
    <div class="game" data-players="3-6">
      <div class="game-meta">
        <span><span class="emoji">üë•</span>: 3‚Äì6 | <span class="emoji">‚è±Ô∏è</span>: 15‚Äì45'</span>
      </div>
      <h2>
        <a href="https://boardgamegeek.com/boardgame/92415/skull" target="_blank">Skull</a>
      </h2>
      <p>A bluffing game of danger, strategy and flowers.</p>
      <small class="owner">(RushHD)</small>
    </div>
  </div>

  <script>
    const playerFilter = document.getElementById('playerFilter');
    const timeFilter = document.getElementById('timeFilter');
    const clearFilters = document.getElementById('clearFilters');
    const games = document.querySelectorAll('.game');

    function getURLParams() {
      const params = new URLSearchParams(window.location.search);
      if (params.has('players')) playerFilter.value = params.get('players');
      if (params.has('time')) timeFilter.value = params.get('time');
    }

    function updateURLParams() {
      const params = new URLSearchParams();
      if (playerFilter.value) params.set('players', playerFilter.value);
      if (timeFilter.value) params.set('time', timeFilter.value);
      const newUrl = window.location.pathname + '?' + params.toString();
      history.replaceState({}, '', newUrl);
    }

    function filterGames() {
      const selectedPlayers = parseInt(playerFilter.value);
      const selectedTime = parseInt(timeFilter.value);

      games.forEach(game => {
        const metaText = game.querySelector('.game-meta')?.textContent || '';
        const timeMatch = metaText.match(/‚è±Ô∏è:\s*(\d+)/);
        const gameTime = timeMatch ? parseInt(timeMatch[1]) : null;

        const dataPlayers = game.dataset.players || '';
        const expansionMax = parseInt(game.dataset.playersWithExpansion || '0');
        const [min, max] = dataPlayers.split('-').map(n => parseInt(n.trim()));

        let matchPlayers = true;
        let matchTime = true;

        if (!isNaN(selectedPlayers)) {
          matchPlayers = selectedPlayers >= min && selectedPlayers <= max;

          const existingWarn = game.querySelector('.expansion-warning');
          if (!matchPlayers && !isNaN(expansionMax) && selectedPlayers <= expansionMax) {
            matchPlayers = true;
            if (!existingWarn) {
              const warn = document.createElement('div');
              warn.className = 'expansion-warning';
              warn.textContent = `‚ö†Ô∏è Requires expansion to support ${selectedPlayers} players`;
              game.appendChild(warn);
            }
          } else if (existingWarn) {
            existingWarn.remove();
          }
        } else {
          const existingWarn = game.querySelector('.expansion-warning');
          if (existingWarn) existingWarn.remove();
        }

        if (!isNaN(selectedTime) && gameTime !== null) {
          matchTime = gameTime <= selectedTime;
        }

        game.style.display = (matchPlayers && matchTime) ? '' : 'none';
      });

      updateURLParams();
    }

    playerFilter.addEventListener('change', filterGames);
    timeFilter.addEventListener('change', filterGames);

    clearFilters.addEventListener('click', () => {
      playerFilter.value = '';
      timeFilter.value = '';

      // Rimuovi tutti i warning
      document.querySelectorAll('.expansion-warning').forEach(w => w.remove());

      filterGames();
    });

    window.addEventListener('DOMContentLoaded', () => {
      getURLParams();
      filterGames();
    });
  </script>
</body>
</html>
